var e=function(e,n,r){return function(t,u,o){return e(u,o)?n&&n(t,u,o):r&&r(t,u,o),t}},n=function(e,n,r){return function(t,u,o){return e(u,o)?n&&n(t,u,o):r&&r(t,u,o),t}},r=function(e,n,r){return function(t,u,o){return e&&e(t,u,o),n(t)[r]++,t}},t=function(e,n,r){return function(t,u,o){return e&&e(t,u,o),n(t)[r]--,t}},u=function(e,n,r){return function(t){return e&&(t=e(t)),n(t)[r]=0,t}},o=function(e,n,r){return function(t,u,o){return n&&n(t,u,o),r(t).sum=r(t).sum+e(u),t}},i=function(e,n,r){return function(t,u,o){return n&&n(t,u,o),r(t).sum=r(t).sum-e(u),t}},c=function(e,n){return function(r){return r=e(r),n(r).sum=0,r}},a=function(e,n,r){return function(e,t,u){return n&&n(e,t,u),r(e).count>0?r(e).avg=r(e).sum/r(e).count:r(e).avg=0,e}},s=function(e,n,r){return function(e,t,u){return n&&n(e,t,u),r(e).count>0?r(e).avg=r(e).sum/r(e).count:r(e).avg=0,e}},f=function(e,n){return function(r){return r=e(r),n(r).avg=0,r}},l=function(e,n){var r;return function(t,u,o){return e&&e(t,u,o),r=Math.floor(n(t).valueList.length/2),n(t).valueList.length%2?n(t).median=n(t).valueList[r]:n(t).median=(n(t).valueList[r-1]+n(t).valueList[r])/2,t}},d=function(e,n){var r;return function(t,u,o){return e&&e(t,u,o),r=Math.floor(n(t).valueList.length/2),0===n(t).valueList.length?(n(t).median=void 0,t):(1===n(t).valueList.length||n(t).valueList.length%2?n(t).median=n(t).valueList[r]:n(t).median=(n(t).valueList[r-1]+n(t).valueList[r])/2,t)}},v=function(e,n){return function(r){return r=e(r),n(r).median=void 0,r}},h=function(e,n){return function(r,t,u){return e&&e(r,t,u),n(r).min=n(r).valueList[0],r}},g=function(e,n){return function(r,t,u){return e&&e(r,t,u),0===n(r).valueList.length?(n(r).min=void 0,r):(n(r).min=n(r).valueList[0],r)}},p=function(e,n){return function(r){return r=e(r),n(r).min=void 0,r}},m=function(e,n){return function(r,t,u){return e&&e(r,t,u),n(r).max=n(r).valueList[n(r).valueList.length-1],r}},y=function(e,n){return function(r,t,u){return e&&e(r,t,u),0===n(r).valueList.length?(n(r).max=void 0,r):(n(r).max=n(r).valueList[n(r).valueList.length-1],r)}},x=function(e,n){return function(r){return r=e(r),n(r).max=void 0,r}};let A=R,b=R,L=R,I=w,O=S;function R(e){for(var n=new Array(e),r=-1;++r<e;)n[r]=0;return n}function w(e,n){for(var r=e.length;r<n;)e[r++]=0;return e}function S(e,n){if(n>32)throw new Error("invalid array width!");return e}function E(e){this.length=e,this.subarrays=1,this.width=8,this.masks={0:0},this[0]=A(e)}"undefined"!=typeof Uint8Array&&(A=function(e){return new Uint8Array(e)},b=function(e){return new Uint16Array(e)},L=function(e){return new Uint32Array(e)},I=function(e,n){if(e.length>=n)return e;var r=new e.constructor(n);return r.set(e),r},O=function(e,n){var r;switch(n){case 16:r=b(e.length);break;case 32:r=L(e.length);break;default:throw new Error("invalid array width!")}return r.set(e),r}),E.prototype.lengthen=function(e){var n,r;for(n=0,r=this.subarrays;n<r;++n)this[n]=I(this[n],e);this.length=e},E.prototype.add=function(){var e,n,r,t,u;for(t=0,u=this.subarrays;t<u;++t)if(r=(~(e=this.masks[t])&e+1)>>>0,!((n=this.width-32*t)>=32)||r)return n<32&&r&1<<n&&(this[t]=O(this[t],n<<=1),this.width=32*t+n),this.masks[t]|=r,{offset:t,one:r};return this[this.subarrays]=A(this.length),this.masks[this.subarrays]=1,this.width+=8,{offset:this.subarrays++,one:1}},E.prototype.copy=function(e,n){var r,t;for(r=0,t=this.subarrays;r<t;++r)this[r][e]=this[r][n]},E.prototype.truncate=function(e){var n,r;for(n=0,r=this.subarrays;n<r;++n)for(var t=this.length-1;t>=e;t--)this[n][t]=0;this.length=e},E.prototype.zero=function(e){var n,r;for(n=0,r=this.subarrays;n<r;++n)if(this[n][e])return!1;return!0},E.prototype.zeroExcept=function(e,n,r){var t,u;for(t=0,u=this.subarrays;t<u;++t)if(t===n?this[t][e]&r:this[t][e])return!1;return!0},E.prototype.zeroExceptMask=function(e,n){var r,t;for(r=0,t=this.subarrays;r<t;++r)if(this[r][e]&n[r])return!1;return!0},E.prototype.only=function(e,n,r){var t,u;for(t=0,u=this.subarrays;t<u;++t)if(this[t][e]!=(t===n?r:0))return!1;return!0},E.prototype.onlyExcept=function(e,n,r,t,u){var o,i,c;for(i=0,c=this.subarrays;i<c;++i)if(o=this[i][e],i===n&&(o&=r),o!=(i===t?u:0))return!1;return!0};var k={array8:R,array16:R,array32:R,arrayLengthen:w,arrayWiden:S,bitarray:E};var z=(e,n)=>function(r){var t=r.length;return[e.left(r,n,0,t),e.right(r,n,0,t)]},q=(e,n)=>{var r=n[0],t=n[1];return function(n){var u=n.length;return[e.left(n,r,0,u),e.left(n,t,0,u)]}},K=e=>[0,e.length],C=e=>e,P=()=>null,M=()=>0;function V(e){function n(e,n,t){for(var u=t-n,o=1+(u>>>1);--o>0;)r(e,o,u,n);return e}function r(n,r,t,u){for(var o,i=n[--u+r],c=e(i);(o=r<<1)<=t&&(o<t&&e(n[u+o])>e(n[u+o+1])&&o++,!(c<=e(n[u+o])));)n[u+r]=n[u+o],r=o;n[u+r]=i}return n.sort=function(e,n,t){for(var u,o=t-n;--o>0;)u=e[n],e[n]=e[n+o],e[n+o]=u,r(e,1,o,n);return e},n}const T=V(C);function N(e){var n=T.by(e);return function(r,t,u,o){var i,c,a,s=new Array(o=Math.min(u-t,o));for(c=0;c<o;++c)s[c]=r[t++];if(n(s,0,o),t<u){i=e(s[0]);do{e(a=r[t])>i&&(s[0]=a,i=e(n(s,0,o)[0]))}while(++t<u)}return s}}T.by=V;const U=N(C);function j(e){function n(n,r,t,u){for(;t<u;){var o=t+u>>>1;r<e(n[o])?u=o:t=o+1}return t}return n.right=n,n.left=function(n,r,t,u){for(;t<u;){var o=t+u>>>1;e(n[o])<r?t=o+1:u=o}return t},n}U.by=N;const F=j(C);F.by=j;var Y=(e,n,r)=>{for(var t=0,u=n.length,o=r?JSON.parse(JSON.stringify(e)):new Array(u);t<u;++t)o[t]=e[n[t]];return o};var W=e=>e+1,B=e=>e-1,J=e=>function(n,r){return n+ +e(r)},G=e=>function(n,r){return n-e(r)};const X=(e,n)=>{const r=e[n];return"function"==typeof r?r.call(e):r},$=/\[([\w\d]+)\]/g;var D=(e,n)=>function(e,n,r,t,u){for(u in t=(r=r.split(".")).splice(-1,1),r)n=n[r[u]]=n[r[u]]||{};return e(n,t)}(X,e,n.replace($,".$1"));function H(){var e,n={add:a,remove:s,dimension:d,groupAll:v,size:h,all:g,allFiltered:p,onChange:m,isElementFiltered:l},r=[],t=0,u=[],o=[],i=[],c=[];function a(u){var i=t,c=u.length;return c&&(r=r.concat(u),e.lengthen(t+=c),o.forEach((function(e){e(u,i,c)})),y("dataAdded")),n}function s(n){for(var o,c=new Array(t),a=[],s="function"==typeof n,f=0,l=0;f<t;++f)o=f,(s?n(r[o],o):e.zero(o))?(a.push(f),c[f]=-1):c[f]=l++;u.forEach((function(e){e(-1,-1,[],a,!0)})),i.forEach((function(e){e(c)}));for(var d=0,v=0;d<t;++d)-1!==c[d]&&(d!==v&&(e.copy(v,d),r[v]=r[d]),++v);r.length=t=v,e.truncate(v),y("dataRemoved")}function f(n){var r,t,u,o,i=Array(e.subarrays);for(r=0;r<e.subarrays;r++)i[r]=-1;for(t=0,u=n.length;t<u;t++)i[(o=n[t].id())>>7]&=~(1<<(63&o));return i}function l(n,r){var t=f(r||[]);return e.zeroExceptMask(n,t)}function d(n,c){if("string"==typeof n){var a=n;n=function(e){return D(e,a)}}var s,f,l,d,v,h,g,p,m,x,A,b,L,I,O={filter:function(e){return null==e?oe():Array.isArray(e)?ue(e):"function"==typeof e?ie(e):te(e)},filterExact:te,filterRange:ue,filterFunction:ie,filterAll:oe,currentFilter:function(){return b},hasCurrentFilter:function(){return L},top:function(n,t){var u,o=[],i=j,a=0;t&&t>0&&(a=t);for(;--i>=N&&n>0;)e.zero(u=h[i])&&(a>0?--a:(o.push(r[u]),--n));if(c)for(i=0;i<R.length&&n>0;i++)e.zero(u=R[i])&&(a>0?--a:(o.push(r[u]),--n));return o},bottom:function(n,t){var u,o,i=[],a=0;t&&t>0&&(a=t);if(c)for(u=0;u<R.length&&n>0;u++)e.zero(o=R[u])&&(a>0?--a:(i.push(r[o]),--n));u=N;for(;u<j&&n>0;)e.zero(o=h[u])&&(a>0?--a:(i.push(r[o]),--n)),u++;return i},group:ae,groupAll:function(){var e=ae(P),n=e.all;return delete e.all,delete e.top,delete e.order,delete e.orderNatural,delete e.size,e.value=function(){return n()[0].value},e},dispose:se,remove:se,accessor:n,id:function(){return d}},R=[],w=function(e){return Z(e).sort((function(e,n){var r=g[e],t=g[n];return r<t?-1:r>t?1:e-n}))},S=K,E=[],V=[],N=0,j=0,X=0;o.unshift(H),o.push(ee),i.push(ne);var $=e.add();function H(r,u,o){var i,a;if(c){X=0,W=0,I=[];for(var f=0;f<r.length;f++)for(W=0,I=n(r[f]);W<I.length;W++)X++;g=[],i=Z(r.length),a=Q(X,1);for(var d=Z(X),y=0,b=0;b<r.length;b++)if((I=n(r[b])).length)for(i[b]=I.length,W=0;W<I.length;W++)g.push(I[W]),d[y]=b,y++;else i[b]=0,R.push(b+u);var L=w(X);g=Y(g,L),p=Y(d,L)}else g=r.map(n),p=w(o),g=Y(g,p);var O,E,z,q=S(g),K=q[0],C=q[1];if(c)if(o=X,A)for(O=0;O<o;++O)A(g[O],O)||(0==--i[p[O]]&&(e[l][p[O]+u]|=s),a[O]=1);else{for(E=0;E<K;++E)0==--i[p[E]]&&(e[l][p[E]+u]|=s),a[E]=1;for(z=C;z<o;++z)0==--i[p[z]]&&(e[l][p[z]+u]|=s),a[z]=1}else if(A)for(O=0;O<o;++O)A(g[O],O)||(e[l][p[O]+u]|=s);else{for(E=0;E<K;++E)e[l][p[E]+u]|=s;for(z=C;z<o;++z)e[l][p[z]+u]|=s}if(!u)return v=g,h=p,m=i,x=a,N=K,void(j=C);var P,M=v,V=h,T=x,U=0;if(f=0,c&&(P=u,u=M.length,o=X),v=new Array(c?u+o:t),h=c?new Array(u+o):Q(t,t),c&&(x=Q(u+o,1)),c){var F=m.length;m=k.arrayLengthen(m,t);for(var W=0;W+F<t;W++)m[W+F]=i[W]}for(var B=0;f<u&&U<o;++B)M[f]<g[U]?(v[B]=M[f],c&&(x[B]=T[f]),h[B]=V[f++]):(v[B]=g[U],c&&(x[B]=a[U]),h[B]=p[U++]+(c?P:u));for(;f<u;++f,++B)v[B]=M[f],c&&(x[B]=T[f]),h[B]=V[f];for(;U<o;++U,++B)v[B]=g[U],c&&(x[B]=a[U]),h[B]=p[U]+(c?P:u);q=S(v),N=q[0],j=q[1]}function ee(e,n,r){E.forEach((function(e){e(g,p,n,r)})),g=p=null}function ne(e){if(c){for(var n=0,r=0;n<R.length;n++)-1!==e[R[n]]&&(R[r]=e[R[n]],r++);for(R.length=r,n=0,r=0;n<t;n++)-1!==e[n]&&(r!==n&&(m[r]=m[n]),r++);m=m.slice(0,r)}for(var u,o=v.length,i=0,a=0;i<o;++i)-1!==e[u=h[i]]&&(i!==a&&(v[a]=v[i]),h[a]=e[u],c&&(x[a]=x[i]),++a);for(v.length=a,c&&(x=x.slice(0,a));a<o;)h[a++]=0;var s=S(v);N=s[0],j=s[1]}function re(n){var r=n[0],t=n[1];if(A)return A=null,ce((function(e,n){return r<=n&&n<t}),0===n[0]&&n[1]===v.length),N=r,j=t,O;var o,i,a,f=[],d=[],g=[],p=[];if(r<N)for(o=r,i=Math.min(N,t);o<i;++o)f.push(h[o]),g.push(o);else if(r>N)for(o=N,i=Math.min(r,j);o<i;++o)d.push(h[o]),p.push(o);if(t>j)for(o=Math.max(r,j),i=t;o<i;++o)f.push(h[o]),g.push(o);else if(t<j)for(o=Math.max(N,t),i=j;o<i;++o)d.push(h[o]),p.push(o);if(c){var b=[],L=[];for(o=0;o<f.length;o++)m[f[o]]++,x[g[o]]=0,1===m[f[o]]&&(e[l][f[o]]^=s,b.push(f[o]));for(o=0;o<d.length;o++)m[d[o]]--,x[p[o]]=1,0===m[d[o]]&&(e[l][d[o]]^=s,L.push(d[o]));if(f=b,d=L,S===K)for(o=0;o<R.length;o++)e[l][a=R[o]]&s&&(e[l][a]^=s,f.push(a));else for(o=0;o<R.length;o++)e[l][a=R[o]]&s||(e[l][a]^=s,d.push(a))}else{for(o=0;o<f.length;o++)e[l][f[o]]^=s;for(o=0;o<d.length;o++)e[l][d[o]]^=s}return N=r,j=t,u.forEach((function(e){e(s,l,f,d)})),y("filtered"),O}function te(e){return b=e,L=!0,re((S=z(F,e))(v))}function ue(e){return b=e,L=!0,re((S=q(F,e))(v))}function oe(){return b=void 0,L=!1,re((S=K)(v))}function ie(e){b=e,L=!0,A=e,S=K,ce(e,!1);var n=S(v);return N=n[0],j=n[1],O}function ce(n,r){var t,o,i,a=[],d=[],g=[],p=[],A=v.length;if(!c)for(t=0;t<A;++t)!(e[l][o=h[t]]&s)^!!(i=n(v[t],t))&&(i?a.push(o):d.push(o));if(c)for(t=0;t<A;++t)n(v[t],t)?(a.push(h[t]),g.push(t)):(d.push(h[t]),p.push(t));if(c){var b=[],L=[];for(t=0;t<a.length;t++)1===x[g[t]]&&(m[a[t]]++,x[g[t]]=0,1===m[a[t]]&&(e[l][a[t]]^=s,b.push(a[t])));for(t=0;t<d.length;t++)0===x[p[t]]&&(m[d[t]]--,x[p[t]]=1,0===m[d[t]]&&(e[l][d[t]]^=s,L.push(d[t])));if(a=b,d=L,r)for(t=0;t<R.length;t++)e[l][o=R[t]]&s&&(e[l][o]^=s,a.push(o));else for(t=0;t<R.length;t++)e[l][o=R[t]]&s||(e[l][o]^=s,d.push(o))}else{for(t=0;t<a.length;t++)e[l][a[t]]&s&&(e[l][a[t]]&=f);for(t=0;t<d.length;t++)e[l][d[t]]&s||(e[l][d[t]]|=s)}u.forEach((function(e){e(s,l,a,d)})),y("filtered")}function ae(n){var o={top:X,all:Y,reduce:$,reduceCount:D,reduceSum:H,order:Z,orderNatural:ee,size:ne,dispose:re,remove:re};V.push(o);var a,d,g,p,m,y,x,A,b=8,L=_(b),I=0,O=P,R=P,w=!0,S=n===P;function z(o,i,s,h){c&&(A=s,s=v.length-o.length,h=o.length);var g,p,E,z,q,C,M=a,V=c?[]:Q(I,L),T=m,U=y,Y=x,W=I,B=0,J=0;for(w&&(T=Y=P),w&&(U=Y=P),a=new Array(I),I=0,d=c?W?d:[]:W>1?k.arrayLengthen(d,t):Q(t,L),W&&(E=(p=M[0]).key);J<h&&!((z=n(o[J]))>=z);)++J;for(;J<h;){for(p&&E<=z?(q=p,C=E,V[B]=I,(p=M[++B])&&(E=p.key)):(q={key:z,value:Y()},C=z),a[I]=q;z<=C&&(g=i[J]+(c?A:s),c?d[g]?d[g].push(I):d[g]=[I]:d[g]=I,q.value=T(q.value,r[g],!0),e.zeroExcept(g,l,f)||(q.value=U(q.value,r[g],!1)),!(++J>=h));)z=n(o[J]);X()}for(;B<W;)a[V[B]=I]=M[B++],X();if(c)for(var G=0;G<t;G++)d[G]||(d[G]=[]);if(I>B)if(c)for(B=0;B<A;++B)for(G=0;G<d[B].length;G++)d[B][G]=V[d[B][G]];else for(B=0;B<s;++B)d[B]=V[d[B]];function X(){c?I++:++I===L&&(V=k.arrayWiden(V,b<<=1),d=k.arrayWiden(d,b),L=_(b))}g=u.indexOf(O),I>1||c?(O=K,R=j):(!I&&S&&(I=1,a=[{key:null,value:Y()}]),1===I?(O=N,R=F):(O=P,R=P),d=null),u[g]=O}function q(e){if(I>1||c){var n,r,o,i=I,s=a,f=Q(i,i);if(c){for(n=0,o=0;n<t;++n)if(-1!==e[n]){for(d[o]=d[n],r=0;r<d[o].length;r++)f[d[o][r]]=1;++o}}else for(n=0,o=0;n<t;++n)-1!==e[n]&&(f[d[o]=d[n]]=1,++o);for(a=[],I=0,n=0;n<i;++n)f[n]&&(f[n]=I++,a.push(s[n]));if(I>1||c)if(c)for(n=0;n<o;++n)for(r=0;r<d[n].length;++r)d[n][r]=f[d[n][r]];else for(n=0;n<o;++n)d[n]=f[d[n]];else d=null;u[u.indexOf(O)]=I>1||c?(R=j,O=K):1===I?(R=F,O=N):R=O=P}else if(1===I){if(S)return;for(var l=0;l<t;++l)if(-1!==e[l])return;a=[],I=0,u[u.indexOf(O)]=O=R=P}}function K(n,t,u,o,i){var v,h,g,p,x;if(!(n===s&&t===l||w))if(c){for(v=0,p=u.length;v<p;++v)if(e.zeroExcept(g=u[v],l,f))for(h=0;h<d[g].length;h++)(x=a[d[g][h]]).value=m(x.value,r[g],!1,h);for(v=0,p=o.length;v<p;++v)if(e.onlyExcept(g=o[v],l,f,t,n))for(h=0;h<d[g].length;h++)(x=a[d[g][h]]).value=y(x.value,r[g],i,h)}else{for(v=0,p=u.length;v<p;++v)e.zeroExcept(g=u[v],l,f)&&((x=a[d[g]]).value=m(x.value,r[g],!1));for(v=0,p=o.length;v<p;++v)e.onlyExcept(g=o[v],l,f,t,n)&&((x=a[d[g]]).value=y(x.value,r[g],i))}}function N(n,t,u,o,i){if(!(n===s&&t===l||w)){var c,d,v,h=a[0];for(c=0,v=u.length;c<v;++c)e.zeroExcept(d=u[c],l,f)&&(h.value=m(h.value,r[d],!1));for(c=0,v=o.length;c<v;++c)e.onlyExcept(d=o[c],l,f,t,n)&&(h.value=y(h.value,r[d],i))}}function j(){var n,u,o;for(n=0;n<I;++n)a[n].value=x();if(c){for(n=0;n<t;++n)for(u=0;u<d[n].length;u++)(o=a[d[n][u]]).value=m(o.value,r[n],!0,u);for(n=0;n<t;++n)if(!e.zeroExcept(n,l,f))for(u=0;u<d[n].length;u++)(o=a[d[n][u]]).value=y(o.value,r[n],!1,u)}else{for(n=0;n<t;++n)(o=a[d[n]]).value=m(o.value,r[n],!0);for(n=0;n<t;++n)e.zeroExcept(n,l,f)||((o=a[d[n]]).value=y(o.value,r[n],!1))}}function F(){var n,u=a[0];for(u.value=x(),n=0;n<t;++n)u.value=m(u.value,r[n],!0);for(n=0;n<t;++n)e.zeroExcept(n,l,f)||(u.value=y(u.value,r[n],!1))}function Y(){return w&&(R(),w=!1),a}function X(e){var n=g(Y(),0,a.length,e);return p.sort(n,0,n.length)}function $(e,n,r){return m=e,y=n,x=r,w=!0,o}function D(){return $(W,B,M)}function H(e){return $(J(e),G(e),M)}function Z(e){function n(n){return e(n.value)}return g=U.by(n),p=T.by(n),o}function ee(){return Z(C)}function ne(){return I}function re(){var e=u.indexOf(O);return e>=0&&u.splice(e,1),(e=E.indexOf(z))>=0&&E.splice(e,1),(e=i.indexOf(q))>=0&&i.splice(e,1),(e=V.indexOf(o))>=0&&V.splice(e,1),o}return arguments.length<1&&(n=C),u.push(O),E.push(z),i.push(q),z(v,h,0,t),D().orderNatural()}function se(){V.forEach((function(e){e.dispose()}));var n=o.indexOf(H);return n>=0&&o.splice(n,1),(n=o.indexOf(ee))>=0&&o.splice(n,1),(n=i.indexOf(ne))>=0&&i.splice(n,1),e.masks[l]&=f,oe()}return l=$.offset,s=$.one,f=~s,d=l<<7|Math.log(s)/Math.log(2),H(r,0,t),ee(r,0,t),O}function v(){var n,i,c,a,s={reduce:v,reduceCount:h,reduceSum:function(e){return v(J(e),G(e),M)},value:function(){f&&(function(){var u;for(n=a(),u=0;u<t;++u)n=i(n,r[u],!0),e.zero(u)||(n=c(n,r[u],!1))}(),f=!1);return n},dispose:g,remove:g},f=!0;function l(u,o){var a;if(!f)for(a=o;a<t;++a)n=i(n,r[a],!0),e.zero(a)||(n=c(n,r[a],!1))}function d(t,u,o,a,s){var l,d,v;if(!f){for(l=0,v=o.length;l<v;++l)e.zero(d=o[l])&&(n=i(n,r[d],s));for(l=0,v=a.length;l<v;++l)e.only(d=a[l],u,t)&&(n=c(n,r[d],s))}}function v(e,n,r){return i=e,c=n,a=r,f=!0,s}function h(){return v(W,B,M)}function g(){var e=u.indexOf(d);return e>=0&&u.splice(e,1),(e=o.indexOf(l))>=0&&o.splice(e,1),s}return u.push(d),o.push(l),l(r,0),h()}function h(){return t}function g(){return r}function p(n){var u=[],o=0,i=f(n||[]);for(o=0;o<t;o++)e.zeroExceptMask(o,i)&&u.push(r[o]);return u}function m(e){if("function"==typeof e)return c.push(e),function(){c.splice(c.indexOf(e),1)};console.warn("onChange callback parameter must be a function!")}function y(e){for(var n=0;n<c.length;n++)c[n](e)}return e=new k.bitarray(0),arguments.length?a(arguments[0]):n}function Q(e,n){return(n<257?k.array8:n<65537?k.array16:k.array32)(e)}function Z(e){for(var n=Q(e,e),r=-1;++r<e;)n[r]=r;return n}function _(e){return 8===e?256:16===e?65536:4294967296}H.heap=T,H.heapselect=U,H.bisect=F,H.permute=Y;var ee=function(e,n,r){var t,u;return function(o,i,c){return n&&n(o,i,c),t=r(o).bisect(r(o).values,e(i),0,r(o).values.length),(u=r(o).values[t])&&u[0]===e(i)?u[1]++:r(o).values.splice(t,0,[e(i),1]),o}},ne=function(e,n,r){var t;return function(u,o,i){return n&&n(u,o,i),t=r(u).bisect(r(u).values,e(o),0,r(u).values.length),r(u).values[t][1]--,u}},re=function(e,n){return function(r){return r=e(r),n(r).values=[],n(r).bisect=H.bisect.by((function(e){return e[0]})).left,r}},te=function(e,n,r){var t,u=H.bisect.by((function(e){return e})).left;return function(o,i,c){return n&&n(o,i,c),t=u(r(o).valueList,e(i),0,r(o).valueList.length),r(o).valueList.splice(t,0,e(i)),o}},ue=function(e,n,r){var t,u=H.bisect.by((function(e){return e})).left;return function(o,i,c){return n&&n(o,i,c),t=u(r(o).valueList,e(i),0,r(o).valueList.length),r(o).valueList.splice(t,1),o}},oe=function(e,n){return function(r){return r=e(r),n(r).valueList=[],r}},ie=function(e,n,r){var t,u;return function(o,i,c){return n&&n(o,i,c),t=r(o).bisect(r(o).values,e(i),0,r(o).values.length),(u=r(o).values[t])&&u[0]===e(i)&&0!==u[1]||r(o).exceptionCount++,o}},ce=function(e,n,r){var t,u;return function(o,i,c){return n&&n(o,i,c),t=r(o).bisect(r(o).values,e(i),0,r(o).values.length),(u=r(o).values[t])&&u[0]===e(i)&&1===u[1]&&r(o).exceptionCount--,o}},ae=function(e,n){return function(r){return r=e(r),n(r).exceptionCount=0,r}},se=function(e,n,r,t){var u,o;return function(i,c,a){return r&&r(i,c,a),u=t(i).bisect(t(i).values,e(c),0,t(i).values.length),(o=t(i).values[u])&&o[0]===e(c)&&0!==o[1]||(t(i).exceptionSum=t(i).exceptionSum+n(c)),i}},fe=function(e,n,r,t){var u,o;return function(i,c,a){return r&&r(i,c,a),u=t(i).bisect(t(i).values,e(c),0,t(i).values.length),(o=t(i).values[u])&&o[0]===e(c)&&1===o[1]&&(t(i).exceptionSum=t(i).exceptionSum-n(c)),i}},le=function(e,n){return function(r){return r=e(r),n(r).exceptionSum=0,r}},de=function(e,n,r){var t,u=H.bisect.by((function(e){return e})).left,o=H.bisect.by((function(e){return e.x})).right;return function(i,c,a){return n&&n(i,c,a),(t=r(i).histogram[o(r(i).histogram,e(c),0,r(i).histogram.length)-1]).y++,t.splice(u(t,e(c),0,t.length),0,e(c)),i}},ve=function(e,n,r){var t,u=H.bisect.by((function(e){return e})).left,o=H.bisect.by((function(e){return e.x})).right;return function(i,c,a){return n&&n(i,c,a),(t=r(i).histogram[o(r(i).histogram,e(c),0,r(i).histogram.length)-1]).y--,t.splice(u(t,e(c),0,t.length),1),i}},he=function(e,n,r){return function(t){t=n(t),r(t).histogram=[];for(var u=[],o=1;o<e.length;o++)(u=[]).x=e[o-1],u.dx=e[o]-e[o-1],u.y=0,r(t).histogram.push(u);return t}},ge=function(e,n,r){return function(t,u,o){return n&&n(t,u,o),r(t).sumOfSq=r(t).sumOfSq+e(u)*e(u),t}},pe=function(e,n,r){return function(t,u,o){return n&&n(t,u,o),r(t).sumOfSq=r(t).sumOfSq-e(u)*e(u),t}},me=function(e,n){return function(r){return r=e(r),n(r).sumOfSq=0,r}},ye=function(e,n){return function(r,t,u){if(e&&e(r,t,u),n(r).count>0){n(r).std=0;var o=n(r).sumOfSq-n(r).sum*n(r).sum/n(r).count;o>0&&(n(r).std=Math.sqrt(o/(n(r).count-1)))}else n(r).std=0;return r}},xe=function(e,n){return function(r,t,u){if(e&&e(r,t,u),n(r).count>0){n(r).std=0;var o=n(r).sumOfSq-n(r).sum*n(r).sum/n(r).count;o>0&&(n(r).std=Math.sqrt(o/(n(r).count-1)))}else n(r).std=0;return r}},Ae=function(e,n){return function(r){return r=e(r),n(r).std=0,r}},be=function(e,n,r){var t,u;return function(o,i,c){return n&&n(o,i,c),t=r(o).nest,e.forEach((function(e){(u=t.filter((function(n){return n.key===e(i)}))[0])?t=u.values:(u=[],t.push({key:e(i),values:u}),t=u)})),t.push(i),o}},Le=function(e,n,r){var t;return function(u,o,i){return n&&n(u,o,i),t=r(u).nest,e.forEach((function(e){t=t.filter((function(n){return n.key===e(o)}))[0].values})),t.splice(t.indexOf(o),1),u}},Ie=function(e,n){return function(r){return r=e(r),n(r).nest=[],r}},Oe=function(e,n,r){return function(t){function u(e){return function(){return r[e](n(t))}}for(var o in e&&(t=e(t)),r)n(t)[o]=u(o);return t}},Re=function(e,n,r){return function(t,u,o){for(var i in n&&n(t,u,o),e)r(t)[i]=e[i](r(t),u);return t}},we=function(e,n,r){return function(e,t,u){return n&&n(e,t,u),r(e).dataList.push(t),e}},Se=function(e,n,r){return function(e,t,u){return n&&n(e,t,u),r(e).dataList.splice(r(e).dataList.indexOf(t),1),e}},Ee=function(e,n){return function(r){return e&&(r=e(r)),n(r).dataList=[],r}},ke=function(e,n,r){return function(n,t,u){return e&&e(n,t,u),r(n,t)}},ze=function(e,n,r){return function(n,t,u){return e&&e(n,t,u),r(n,t)}},qe=function(e,n,r){return function(n){return e&&(n=e(n)),r(n)}};var Ke={build:function A(b,L,I){I||(I=function(e){return e});var O={reduceAdd:L.reduceAdd,reduceRemove:L.reduceRemove,reduceInitial:L.reduceInitial};(b.count||b.std)&&(L.reduceAdd=r(L.reduceAdd,I,b.count),L.reduceRemove=t(L.reduceRemove,I,b.count),L.reduceInitial=u(L.reduceInitial,I,b.count)),b.sum&&(L.reduceAdd=o(b.sum,L.reduceAdd,I),L.reduceRemove=i(b.sum,L.reduceRemove,I),L.reduceInitial=c(L.reduceInitial,I)),b.avg&&(b.count&&b.sum?(L.reduceAdd=a(b.sum,L.reduceAdd,I),L.reduceRemove=s(b.sum,L.reduceRemove,I),L.reduceInitial=f(L.reduceInitial,I)):console.error("You must set .count(true) and define a .sum(accessor) to use .avg(true).")),b.exceptionCount&&(b.exceptionAccessor?(L.reduceAdd=ie(b.exceptionAccessor,L.reduceAdd,I),L.reduceRemove=ce(b.exceptionAccessor,L.reduceRemove,I),L.reduceInitial=ae(L.reduceInitial,I)):console.error("You must define an .exception(accessor) to use .exceptionCount(true).")),b.exceptionSum&&(b.exceptionAccessor?(L.reduceAdd=se(b.exceptionAccessor,b.exceptionSum,L.reduceAdd,I),L.reduceRemove=fe(b.exceptionAccessor,b.exceptionSum,L.reduceRemove,I),L.reduceInitial=le(L.reduceInitial,I)):console.error("You must define an .exception(accessor) to use .exceptionSum(accessor).")),(b.valueList||b.median||b.min||b.max)&&(L.reduceAdd=te(b.valueList,L.reduceAdd,I),L.reduceRemove=ue(b.valueList,L.reduceRemove,I),L.reduceInitial=oe(L.reduceInitial,I)),b.dataList&&(L.reduceAdd=we(b.dataList,L.reduceAdd,I),L.reduceRemove=Se(b.dataList,L.reduceRemove,I),L.reduceInitial=Ee(L.reduceInitial,I)),b.median&&(L.reduceAdd=l(L.reduceAdd,I),L.reduceRemove=d(L.reduceRemove,I),L.reduceInitial=v(L.reduceInitial,I)),b.min&&(L.reduceAdd=h(L.reduceAdd,I),L.reduceRemove=g(L.reduceRemove,I),L.reduceInitial=p(L.reduceInitial,I)),b.max&&(L.reduceAdd=m(L.reduceAdd,I),L.reduceRemove=y(L.reduceRemove,I),L.reduceInitial=x(L.reduceInitial,I)),b.exceptionAccessor&&(L.reduceAdd=ee(b.exceptionAccessor,L.reduceAdd,I),L.reduceRemove=ne(b.exceptionAccessor,L.reduceRemove,I),L.reduceInitial=re(L.reduceInitial,I)),b.histogramValue&&b.histogramThresholds&&(L.reduceAdd=de(b.histogramValue,L.reduceAdd,I),L.reduceRemove=ve(b.histogramValue,L.reduceRemove,I),L.reduceInitial=he(b.histogramThresholds,L.reduceInitial,I)),b.sumOfSquares&&(L.reduceAdd=ge(b.sumOfSquares,L.reduceAdd,I),L.reduceRemove=pe(b.sumOfSquares,L.reduceRemove,I),L.reduceInitial=me(L.reduceInitial,I)),b.std&&(b.sumOfSquares&&b.sum?(L.reduceAdd=ye(L.reduceAdd,I),L.reduceRemove=xe(L.reduceRemove,I),L.reduceInitial=Ae(L.reduceInitial,I)):console.error("You must set .sumOfSq(accessor) and define a .sum(accessor) to use .std(true). Or use .std(accessor).")),b.custom&&(L.reduceAdd=ke(L.reduceAdd,I,b.custom.add),L.reduceRemove=ze(L.reduceRemove,I,b.custom.remove),L.reduceInitial=qe(L.reduceInitial,I,b.custom.initial)),b.nestKeys&&(L.reduceAdd=be(b.nestKeys,L.reduceAdd,I),L.reduceRemove=Le(b.nestKeys,L.reduceRemove,I),L.reduceInitial=Ie(L.reduceInitial,I)),b.aliasKeys&&(L.reduceInitial=Oe(L.reduceInitial,I,b.aliasKeys)),b.aliasPropKeys&&(L.reduceAdd=Re(b.aliasPropKeys,L.reduceAdd,I),L.reduceRemove=Re(b.aliasPropKeys,L.reduceRemove,I)),b.filter&&(L.reduceAdd=e(b.filter,L.reduceAdd,O.reduceAdd,I),L.reduceRemove=n(b.filter,L.reduceRemove,O.reduceRemove,I)),b.values&&Object.getOwnPropertyNames(b.values).forEach((function(e){var n;L.reduceInitial=(n=L.reduceInitial,function(r){return r=n(r),I(r)[e]={},r}),A(b.values[e].parameters,L,(function(n){return n[e]}))}))}};function Ce(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;++r){var t=arguments[r];if(null!=t)for(var u in t)t.hasOwnProperty(u)&&(n[u]=t[u])}return n}var Pe={build:function e(n,r){function t(e){if("string"==typeof e){var n=e;return function(e){return e[n]}}return e}function u(e){if("string"==typeof e){var n=e;return function(e){return+e[n]}}return e}n.fromObject=function(e){return arguments.length?(Ce(r,e),n):r},n.toObject=function(){return r},n.count=function(e,t){return arguments.length?(t||(t="count"),r.count=t,n):r.count},n.sum=function(e){return arguments.length?(e=u(e),r.sum=e,n):r.sum},n.avg=function(e){return arguments.length?("function"==typeof(e=u(e))?(r.sum&&r.sum!==e&&console.warn("SUM aggregation is being overwritten by AVG aggregation"),r.sum=e,r.avg=!0,r.count="count"):r.avg=e,n):r.avg},n.exception=function(e){return arguments.length?(e=t(e),r.exceptionAccessor=e,n):r.exceptionAccessor},n.filter=function(e){return arguments.length?(r.filter=e,n):r.filter},n.valueList=function(e){return arguments.length?(e=t(e),r.valueList=e,n):r.valueList},n.median=function(e){return arguments.length?("function"==typeof(e=u(e))&&(r.valueList&&r.valueList!==e&&console.warn("VALUELIST accessor is being overwritten by median aggregation"),r.valueList=e),r.median=e,n):r.median},n.min=function(e){return arguments.length?("function"==typeof(e=u(e))&&(r.valueList&&r.valueList!==e&&console.warn("VALUELIST accessor is being overwritten by min aggregation"),r.valueList=e),r.min=e,n):r.min},n.max=function(e){return arguments.length?("function"==typeof(e=u(e))&&(r.valueList&&r.valueList!==e&&console.warn("VALUELIST accessor is being overwritten by max aggregation"),r.valueList=e),r.max=e,n):r.max},n.exceptionCount=function(e){return arguments.length?("function"==typeof(e=t(e))?(r.exceptionAccessor&&r.exceptionAccessor!==e&&console.warn("EXCEPTION accessor is being overwritten by exception count aggregation"),r.exceptionAccessor=e,r.exceptionCount=!0):r.exceptionCount=e,n):r.exceptionCount},n.exceptionSum=function(e){return arguments.length?(e=u(e),r.exceptionSum=e,n):r.exceptionSum},n.histogramValue=function(e){return arguments.length?(e=u(e),r.histogramValue=e,n):r.histogramValue},n.histogramBins=function(e){return arguments.length?(r.histogramThresholds=e,n):r.histogramThresholds},n.std=function(e){return arguments.length?("function"==typeof(e=u(e))?(r.sumOfSquares=e,r.sum=e,r.count="count",r.std=!0):r.std=e,n):r.std},n.sumOfSq=function(e){return arguments.length?(e=u(e),r.sumOfSquares=e,n):r.sumOfSquares},n.value=function(n,t){if(arguments.length&&"string"==typeof n)return r.values||(r.values={}),r.values[n]={},r.values[n].parameters={order:!1,avg:!1,count:!1,sum:!1,exceptionAccessor:!1,exceptionCount:!1,exceptionSum:!1,filter:!1,valueList:!1,median:!1,histogramValue:!1,min:!1,max:!1,histogramThresholds:!1,std:!1,sumOfSquares:!1,values:!1,nestKeys:!1,aliasKeys:!1,aliasPropKeys:!1,groupAll:!1,dataList:!1,custom:!1},e(r.values[n],r.values[n].parameters),t&&(r.values[n].accessor=t),r.values[n];console.error("'value' requires a string argument.")},n.nest=function(e){return arguments.length?(e.map(t),r.nestKeys=e,n):r.nestKeys},n.alias=function(e){return arguments.length?(r.aliasKeys=e,n):r.aliasKeys},n.aliasProp=function(e){return arguments.length?(r.aliasPropKeys=e,n):r.aliasPropKeys},n.groupAll=function(e){return arguments.length?(r.groupAll=e,n):r.groupAll},n.dataList=function(e){return arguments.length?(r.dataList=e,n):r.dataList},n.custom=function(e){return arguments.length?(r.custom=e,n):r.custom}}};var Me=function(e){return function(n){return n[e]}};const Ve=function(e,n){return e||(e=function(e){return e}),function(r,t){n&&n(r,t);var u=e(r),o=e(t);return void 0!==o.count&&(u.count+=o.count),void 0!==o.sum&&(u.sum+=o.sum),void 0!==o.avg&&(u.avg=u.sum/u.count),r}},Te=function(e,n,r){n.reduceInitial();var t=r.values?Object.keys(r.values):[],u=Ve();if(t.length)for(var o=0;o<t.length;++o)u=Ve(Me(t[o]),u);return function(r,t){if(!arguments.length)return e();if(r===1/0||!r)return e();var o=e(),i=r-1;if(o.length<=r)return o;var c=o.slice(0,i),a={key:t||"Others"};a.value=n.reduceInitial();for(var s=i;s<o.length;++s)u(a.value,o[s].value);return c.push(a),c}};var Ne=function(e){if("function"==typeof e)return e;if(~e.indexOf(".")){var n=e.split(".");return function(e){return n.reduce((function(e,n){return e[n]}),e)}}return function(n){return n[e]}};function Ue(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}var je=function(e,n){return function(r,t){return n(e(r),e(t))}};function Fe(e){return function(n,r){return 1===arguments.length&&(r=Ue),e().sort(je(Ne(n),r))}}function Ye(){var e={order:!1,avg:!1,count:!1,sum:!1,exceptionAccessor:!1,exceptionCount:!1,exceptionSum:!1,filter:!1,valueList:!1,median:!1,histogramValue:!1,min:!1,max:!1,histogramThresholds:!1,std:!1,sumOfSquares:!1,values:!1,nestKeys:!1,aliasKeys:!1,aliasPropKeys:!1,groupAll:!1,dataList:!1,custom:!1},n={};function r(r){if(n={reduceAdd:function(e){return e},reduceRemove:function(e){return e},reduceInitial:function(){return{}}},Ke.build(e,n),e.groupAll)if(r.top)console.warn("'groupAll' is defined but attempting to run on a standard dimension.group(). Must run on dimension.groupAll().");else{var t,u,o,i,c,a=H.bisect.by((function(e){return e.key})).left;r.reduce((function(r,s,f){for(o=e.groupAll(s),i=o.length,u=0;u<i;u++)c=o[u],r[t=a(r,c,0,r.length)]&&r[t].key===c||r.splice(t,0,{key:c,value:n.reduceInitial()}),n.reduceAdd(r[t].value,s,f);return r}),(function(r,c,s){for(o=e.groupAll(c),i=o.length,u=0;u<i;u++)t=a(r,o[u],0,r.length),n.reduceRemove(r[t].value,c,s);return r}),(function(){return[]})),r.all||(r.all=function(){return this.value()})}else r.reduce(n.reduceAdd,n.reduceRemove,n.reduceInitial);return We(r,e,n),r}return Pe.build(r,e),r}!function(e){e.postprocessors={},e.registerPostProcessor=function(n,r){e.postprocessors[n]=r},e.registerPostProcessor("cap",Te),e.registerPostProcessor("sortBy",Fe)}(Ye);const We=function(e){return function(n,r,t){n.post=function(){var u=function e(){return e.all()};u.all=function(){return n.all()};var o=e.postprocessors;return Object.keys(o).forEach((function(e){u[e]=function(){var n=u.all,i=[].slice.call(arguments);return u.all=function(){return o[e](n,t,r).apply(null,i)},u}})),u}}}(Ye);export default Ye;
//# sourceMappingURL=reductio.js.map
